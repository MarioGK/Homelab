[[procedure]]
name = "Sync"
config.webhook_secret = "KomodoHomelab"

[[procedure.config.stage]]
name = "Clone Repo"
enabled = true
executions = [
  { execution.type = "CloneRepo", execution.params.repo = "MarioGK/Homelab", enabled = true }
]

[[procedure.config.stage]]
name = "Pull Again just to make sure"
enabled = true
executions = [
  { execution.type = "PullRepo", execution.params.repo = "MarioGK/Homelab", enabled = true }
]

[[procedure.config.stage]]
name = "Sync resources"
enabled = true
executions = [
  { execution.type = "RunSync", execution.params.sync = "Homelab Sync", enabled = true }
]

[[procedure.config.stage]]
name = "Batch deploy stacks"
enabled = true
executions = [
  { execution.type = "BatchDeployStackIfChanged", execution.params.pattern = "*", enabled = true }
]

[[procedure.config.stage]]
name = "Build images"
enabled = true
executions = [
  { execution.type = "BatchRunBuild", enabled = false }
]